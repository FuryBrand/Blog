---
layout: post
title:  "一些异常情况的测试点"
date:   2020-09-30 20:22:25 +0800
categories: jekyll update
---

## 引子

最近和我大哥闲聊时，提到了关于nginx的使用，我把自己的这篇文章“[Linux-浅谈Nginx的反向代理 即http请求经历了什么😀]({% post_url 2019-03-12-Linux-Nginx-Tomcat-small-talk %})”丢给他看，被变相嫌弃太入门了😷。以此为契机我们展开了一些讨论，有些东西没搞清楚的后续也去调查了下，有些没有调查出结论的，也稍微有些自己的推测和猜想。我会以`我推测`开头。现在网络中充斥着太多的皮毛知识了，其实有些东西是需要基础知识的支撑的。关于网络知识，上学时的教材应该是《计算机网络(第5版)》(谢希仁编著，电子工业出版社出版)。或许是知识需要与实践相辅相成才能真正沉淀下来吧。上学时学到的很多都已经还给老师了😂本次又拿出来翻了翻又有些收获。由于这个讨论内容很跳跃，所以我用问答的形式来表述。也算沉淀下自己的知识。

对了，还是那句老话，秉持怀疑的视角来看，切莫偏听偏信。

## Q2.http协议是基于tcp协议的？

是的。关于这个问题可以看下《计算机网络》，或者看下这个博文[《HTTP协议超级详解》](https://www.cnblogs.com/an-wen/p/11180076.html)。

我在这里就叨逼叨一些其他的。首先把协议的概念定义定下来，网络协议是通信计算机双方必须共同遵从的一组约定（百度百科原文）。要我说的话，就是通讯双方约定好怎么去“翻译”对方发过来的消息。如果我们两个在通信的时候约定了一种特殊的解读方式，其实也可以称为是协议，只不过是“私有协议”。一般来说也有基于某种传输协议才行，比如SOAP协议是基于http协议传输的。

既然谈到了“基于”，其实体现了互联网通信是分层结构的。分层思想在很多地方都有应用，大名鼎鼎的MVC也是为了解决复杂程序而提出的。互联网通信也是复杂的，通信时要确认对方机器的在线状态，要解决传输过程中的出现的数据错误、丢失或者重复等等问题。所以利用分层思想将复杂问题简化，每一层保证自己职责范围内的功能可用，从而保证整体通信。

相较于OSI的复杂结构，TCP/IP的四层网络结构目前应用是最广的。自上而下的四层结构依次为：
1. 应用层（http、ftp、SMTP等）
2. 运输层（TCP、UDP）
3. 网络层（IP）
4. 网络接口层

TCP协议的职责是提供可靠的传输；UDP协议不可靠但是效率较TCP高，所以更多的应用于在线游戏、流媒体视频领域。而HTTP便是基于TCP（可靠）的基础之上定义的通讯规则。

## Q1.nginx和tomcat是通过什么协议通信的？

回答这个问题其实也回答了我在那篇文章中遗留的问题，即“http请求由nginx转发给tomcat之后，服务端给浏览器返回的信息tomcat是怎么找到nginx的？”。

我的答案是“我推测nginx和tomcat是通过http协议通信的”。为什么是推测，因为我用中文在百度上搜索，用英文在谷歌上搜索，跑去看nginx的手册都没有找到直接的说法说nginx和tomcat是通过http协议通信。为什么会有这个疑惑，因为nginx在作为反向代理和web服务器交互的时候是支持比如`uwsgi`协议的（参考[Python-mock一个提供http协议的服务]({% post_url 2018-12-5-Python-mock-http %}#43-配置nginx)）。


## Q3.WebService和WebSocket是什么关系，tomcat是什么？